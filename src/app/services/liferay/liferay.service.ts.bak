import {Injectable} from '@angular/core';
import {HttpClient,HttpHeaders} from '@angular/common/http';
import {Subject} from 'rxjs';
import {BehaviorSubject} from 'rxjs';

@Injectable()
export class LiferayService {

  embedded : object [];
  
  constructor(public http: HttpClient) {
  }

  getHelloMessageFromJohn() {
	return "hello";
  }
  
  getLiferayWebContent() {    
	let username = "test@liferay.com";
	let passwd = "test";
	let credentialsHash = this.encodeCredentials(username, passwd);

	let headers = new HttpHeaders({
		'Content-Type': 'application/json',
		'Authorization': credentialsHash
	});	
	
	const dataSub = new Subject<string>();
	this.http.get(
      `http://localhost:8888/o/api/structured-contents/42685`, {headers})
      .subscribe((data) => {
        dataSub.next(data['renderedContentsByTemplate'].elements[0].renderedContent);
      }, (err) => {
        console.log(err);
      });
    
	return dataSub;
  }
  
  encodeCredentials(username: string, passwd: string) {
    let token = username + ":" + passwd;
	return "Basic " + btoa(token);
  }

}
